<!DOCTYPE html>
<html lang=”en”>
    <head>
        <meta charset="utf-8">
        <title>Detect Content Change</title>
    </head>
    <body>
    	<textarea id="old"  rows="30" cols="100" style="width:40%; height:auto; background-color: lightyellow;">old_code</textarea>
    	<textarea id="new"  rows="30" cols="100" style="width:40%; height:auto; background-color: lightblue;">new_code</textarea>
    	<br/><br/>
    	<label> Result </label>
    	<br/>
    	<textarea id="result" 
    	          rows="20" cols="100"  
    	          style="width:81%; height:auto; background-color: lightgrey;">&nbsp;</textarea>
    	<br/>
    	<br/>
    	<button class="button" id="submit"  onclick="compare_content()">Compare</button>
    </body>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js"></script>
    <script type="text/javascript">
    	function compare_content() {
    		source_code_sans_space_concatenated = function(text) {
    			var all_lines = text.split('\n');
    			var all_lines_concatenated = '';
    			$.each(all_lines, function(i, v) {
    				all_lines_concatenated += v;
    			})

    			return all_lines_concatenated.trim();
    		};
    		var source_code_new = source_code_sans_space_concatenated($('#new').val()).split('');
    		var source_code_old = source_code_sans_space_concatenated($('#old').val()).split('');
            var max_length = source_code_old.length - source_code_new.length? source_code_old.length : source_code_new.length

			if (source_code_new.length != source_code_old.length)	 {
				 $('#result').val('Length of content mismatch');
			}
			get_mismatch_line_no = function(source_locator, char_index) {
    						var all_lines = $(source_locator).val().split('\n');
    						var current_concatenated_length = 0;
    						for (var line_no = 0; line_no < all_lines.length; line_no++) {
    							current_concatenated_length += all_lines[line_no].length;
    							if(current_concatenated_length >= (char_index+1)) {
    								break;
    							}
    							
    						}
    						return line_no + 1;
    			};
    		
    		for (var i = 0; i < max_length; i++) {
    			var output = '';
    			(function(char_index) {
    				if(source_code_old[char_index] != source_code_new[char_index]) {
    					output += '\n mismatch of content detected :::';
    					output += '\n original code ::::' + source_code_old[char_index];
    					output += '\n formatted ::::' + source_code_new[char_index];
    					output += '\n Original source code mismatch detected at line no ::: ' + get_mismatch_line_no('#old', char_index);
    					output += '\n Formatted source code mismatch detected at line no ::: ' + get_mismatch_line_no('#new', char_index);
                        $('#result').val($('#result').val() + output);
    					
    				}
    				
    			})(i);
    			if(output.length > 1) {
    				return;
    			}

    		}
        }
    
    	
    </script>
</html>
